<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"eth_account_AccountModel.js.html":{"id":"eth_account_AccountModel.js.html","title":"Source: eth/account/AccountModel.js","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Source: eth/account/AccountModel.js /*jslint node: true*/ /*globals Promise: true*/ /** @namespace eth */ /** @custom xxx */ 'use strict'; var xreq = require('xreq'), helpers = xreq.helpers('modelHelpers'), ObjectID = require('mongodb').ObjectID; /** @module account */ /** @custom xxx */ class AccountModel { /** * Model to handle the accounts collection * @param {Object} &quot;db&quot; - DI for database * @param {Object} &quot;i18n&quot; - DI for i18n * @param {Object} &quot;enume&quot; - DI for enum * @param {Object} &quot;moment&quot; - DI for moment * @param {Object} &quot;config&quot; - DI for config * @param {Object} &quot;ethHelper&quot; - DI for ethHelper * @constructor * @returns {Object} Returns a new AccountModel object. */ constructor (i18n, enume, moment, config, ethHelper) { //this.collection = db.collection(&quot;contracts&quot;); this.i18n = i18n; this.contract = {}; this.enum = enume; this.moment = moment; this.config = config; this.ethHelper = ethHelper; } /** * Returns account details * @public * @memberOf AccountModel * @param {string} account Account address * @custom public * @returns {Promise} Returns a new promise with the account detail. * @TODO serialize javascript object and store in cookie */ get (account) { const ethHelp = this.ethHelper; return new Promise(function (resolve, reject) { ethHelp.util.status().then(function(result){ ethHelp.trx.get(trxhash) .then(function (result) { resolve(result); }) .catch(function (error) { reject(error); }); }).catch(function (error) { reject(error); }); }); } } module.exports = AccountModel; × Search results Close "},"eth_contract_ContractModel.js.html":{"id":"eth_contract_ContractModel.js.html","title":"Source: eth/contract/ContractModel.js","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Source: eth/contract/ContractModel.js /*jslint node: true*/ /*globals Promise: true*/ /** @namespace eth */ /** @custom xxx */ 'use strict'; var xreq = require('xreq'), helpers = xreq.helpers('modelHelpers'), ObjectID = require('mongodb').ObjectID; /** @module contract */ /** @custom xxx */ class ContractModel { /** * Model to handle the contracts collection * @param {Object} &quot;db&quot; - DI for database * @param {Object} &quot;i18n&quot; - DI for i18n * @param {Object} &quot;enume&quot; - DI for enum * @param {Object} &quot;moment&quot; - DI for moment * @param {Object} &quot;config&quot; - DI for config * @param {Object} &quot;ethHelper&quot; - DI for ethHelper * @constructor * @returns {Object} Returns a new ContractModel object. */ constructor (i18n, enume, moment, config, ethHelper) { //this.collection = db.collection(&quot;contracts&quot;); this.i18n = i18n; this.contract = {}; this.enum = enume; this.moment = moment; this.config = config; this.ethHelper = ethHelper; } /** * Deploys a new contract in the Ethereum blockchain. * @public * @memberOf ContractModel * @param {string} contract Contract name * @param {string} sender Address of the sender, if null it will use the default one * @param {boolean} wait If set to true it will wait until the contract is mined. If not it will return the transactionHash straight away and some other process will have to monitor the status. * @custom public * @returns {Promise} Returns a new promise with the contract detail. */ deployContract (contract,sender,wait) { let compiled, abi; const ethHelp = this.ethHelper; return new Promise(function (resolve, reject) { ethHelp.util.status().then(function(result){ //ethHelp.account.default(sender); ethHelp.contract.get(contract + '.sol') .then(function (result) { return ethHelp.util.compile(result); }) .then(function (result) { compiled = helpers.json.getFirst(result); abi = compiled.info.abiDefinition; // Check ethHelp.contract.saveAbi(contract,abi); // create contract return ethHelp.contract.new(contract,compiled.code,abi,'0xaf263b8b9ce09c5b8ac2abe56a2023f08e55fd97',wait); }) .then(function (result) { resolve(result); }) .catch(function (error) { reject(error); }); }).catch(function (error) { reject(error); }); }); } /** * Executes a message call transaction, which is directly executed in the VM of the node, but never mined into the blockchain. * @public * @memberOf ContractModel * @param {string} contract Contract name * @param {string} sender Address of the sender, if null it will use the default one * @param {boolean} wait If set to true it will wait until the contract is mined. If not it will return the transactionHash straight away and some other process will have to monitor the status. * @custom public * @returns {Promise} Returns a new promise with the contract detail. */ call (contract,address,sender,data,wait) { const ethHelp = this.ethHelper; return new Promise(function (resolve, reject) { ethHelp.util.status().then(function(result){ ethHelp.contract.get(contract) .then(function (result) { //TODO DO WE NEED THIS? return ethHelp.contract.instance(contract,address); }) .then(function (result) { ethHelp.account.default(sender); return ethHelp.trx.call(address,data); }) .then(function (result) { resolve(result); }) .catch(function (error) { reject(error); }); }).catch(function (error) { reject(error); }); }); } /** * Sends a transaction to the network. * @public * @memberOf ContractModel * @param {string} contract Contract name * @param {string} sender Address of the sender, if null it will use the default one * @param {boolean} wait If set to true it will wait until the contract is mined. If not it will return the transactionHash straight away and some other process will have to monitor the status. * @custom public * @returns {Promise} Returns a new promise with the contract detail. */ sendTransaction (contract,from,data,method) { const ethHelp = this.ethHelper; return new Promise(function (resolve, reject) { ethHelp.util.status().then(function(result){ ethHelp.contract.call(contract,from,data,method) .then(function (result) { resolve(result); }) .catch(function (error) { reject(error); }); }).catch(function (error) { reject(error); }); }); } } module.exports = ContractModel; × Search results Close "},"eth_locker_LockerModel.js.html":{"id":"eth_locker_LockerModel.js.html","title":"Source: eth/locker/LockerModel.js","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Source: eth/locker/LockerModel.js /*jslint node: true*/ /*globals Promise: true*/ /** @namespace eth */ /** @custom xxx */ 'use strict'; var xreq = require('xreq'), helpers = xreq.helpers('modelHelpers'), ObjectID = require('mongodb').ObjectID; /** @module contract */ /** @custom xxx */ class LockerModel { /** * Model to handle the contracts collection * @param {Object} &quot;db&quot; - DI for database * @param {Object} &quot;i18n&quot; - DI for i18n * @param {Object} &quot;enume&quot; - DI for enum * @param {Object} &quot;moment&quot; - DI for moment * @param {Object} &quot;config&quot; - DI for config * @param {Object} &quot;ethHelper&quot; - DI for ethHelper * @constructor * @returns {Object} Returns a new ContractModel object. */ constructor (i18n, enume, moment, config, ethHelper) { //this.collection = db.collection(&quot;contracts&quot;); this.i18n = i18n; this.contract = {}; this.enum = enume; this.moment = moment; this.config = config; this.ethHelper = ethHelper; } /** * Returns . * @public * @memberOf LockerModel * @param {string} contract Contract name * @param {string} sender Address of the sender, if null it will use the default one * @param {boolean} wait If set to true it will wait until the contract is mined. If not it will return the transactionHash straight away and some other process will have to monitor the status. * @custom public * @returns {Promise} Returns a new promise with the contract detail. */ status (contract, sender) { let compiled, abi; const ethHelp = this.ethHelper; return new Promise(function (resolve, reject) { return ethHelp.util.status().then(function(result){ ethHelp.account.default(sender); var mSig = ethHelp.util.sig('getStatus()'), mVal = '0000000000000000000000000000000000000000000000000000000000000000', code = '0x' + mSig + mVal; ethHelp.trx.call(ethHelp.account.get(sender), contract, code) .then(function (result) { resolve(result); }) .catch(function (error) { reject(error); }); }).catch(function (error) { reject(error); }); }); } /** * Returns . * @public * @memberOf LockerModel * @param {string} contract Contract name * @param {string} sender Address of the sender, if null it will use the default one * @param {boolean} wait If set to true it will wait until the contract is mined. If not it will return the transactionHash straight away and some other process will have to monitor the status. * @custom public * @returns {Promise} Returns a new promise with the contract detail. */ unlock (contract, sender) { const ethHelp = this.ethHelper; return new Promise(function (resolve, reject) { return ethHelp.util.status().then(function(result){ ethHelp.account.default(sender); var mSig = ethHelp.util.sig('unlock()'), mVal = '0000000000000000000000000000000000000000000000000000000000000000', code = mSig + mVal; ethHelp.trx.send(ethHelp.account.get(sender), contract, code) .then(function (result) { resolve(result); }) .catch(function (error) { reject(error); }); }).catch(function (error) { reject(error); }); }); } /** * Returns . * @public * @memberOf LockerModel * @param {string} contract Contract name * @param {string} sender Address of the sender, if null it will use the default one * @param {boolean} wait If set to true it will wait until the contract is mined. If not it will return the transactionHash straight away and some other process will have to monitor the status. * @custom public * @returns {Promise} Returns a new promise with the contract detail. */ deploy (name,waitUntilMined) { var compiled, abi, ethHelp = this.ethHelper; return new Promise(function (resolve, reject) { ethHelp.util.getContractOrAbi(name) .then(function (result) { return ethHelp.util.compile(result); }) .then(function (result) { compiled = result; abi = compiled.info.abiDefinition; //console.log('abi',abi); return ethHelp.util.saveAbi(name,abi); }) .then(function (result) { var code = compiled.code; // create contract return ethHelp.contract.new(name,code,abi,10,waitUntilMined); }) .then(function (result) { resolve(result); }) .catch(function (error) { reject(error); }); }); } } module.exports = LockerModel; × Search results Close "},"eth_locker_LockerService.js.html":{"id":"eth_locker_LockerService.js.html","title":"Source: eth/locker/LockerService.js","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Source: eth/locker/LockerService.js /*jslint node: true*/ /** @namespace eth */ /** @custom xxx */ 'use strict'; var Exceptions, xcatalog, moment, xreq = require('xreq'), Validator = xreq.utils('Validator'); /** @module contract */ /** @custom xxx */ class LockerService { /** * Service that will handle payments lifecycle * @param {Object} &quot;exceptions&quot; - DI for exceptions * @constructor * @returns {Object} Returns a new ContractService service object. */ constructor (catalog, moment, i18n, enume, exceptions, lockerModel) { Exceptions = exceptions; xcatalog = catalog; moment = moment; this.i18n = i18n; this.model = lockerModel; this.enume = enume; } /** * Deploys a new contract in the Ethereum blockchain. * @memberOf EthContractService * @param {string} contract Contract name * @param {string} sender Address of the sender, if null it will use the default one * @param {boolean} wait If set to true it will wait until the contract is mined. If not it will return the transactionHash straight away and some other process will have to monitor the status. * @custom public * @returns {string} Returns the transaction hash id of the contract deployment */ status(contract, sender) { let itself = this; return new Promise(function (resolve, reject) { // var validator = new Validator({ contract : contract, wait: wait}); // validator.path('contract', ['string', 'required']); // validator.path('wait', ['boolean', 'required']); // if (validator.hasErrors()) { // let vErrors = validator.getErrors(); // reject(new Exceptions.Validation(vErrors) ); // return; // } else { return itself.model.status(contract, sender) .then(function(response){ console.log('back from model'); resolve(response); },function(err){ reject(err); }) .catch(function(err){ reject(err); }); //} }); } /** * Deploys a new contract in the Ethereum blockchain. * @memberOf EthContractService * @param {string} contract Contract name * @param {string} sender Address of the sender, if null it will use the default one * @param {boolean} wait If set to true it will wait until the contract is mined. If not it will return the transactionHash straight away and some other process will have to monitor the status. * @custom public * @returns {string} Returns the transaction hash id of the contract deployment */ unlock(contract, sender) { let itself = this; return new Promise(function (resolve, reject) { return itself.model.unlock(contract, sender) .then(function(response){ resolve(response); },function(err){ reject(err); }) .catch(function(err){ reject(err); }); //} }); } /** * Deploys a new contract in the Ethereum blockchain. * @memberOf EthContractService * @param {string} contract Contract name * @param {string} sender Address of the sender, if null it will use the default one * @param {boolean} wait If set to true it will wait until the contract is mined. If not it will return the transactionHash straight away and some other process will have to monitor the status. * @custom public * @returns {string} Returns the transaction hash id of the contract deployment */ deploy(name,waitUntilMined) { let itself = this; return new Promise(function (resolve, reject) { return itself.model.deploy(name,waitUntilMined) .then(function(response){ resolve(response); },function(err){ reject(err); }) .catch(function(err){ reject(err); }); //} }); } } module.exports = LockerService; × Search results Close "},"eth_contract_ContractService.js.html":{"id":"eth_contract_ContractService.js.html","title":"Source: eth/contract/ContractService.js","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Source: eth/contract/ContractService.js /*jslint node: true*/ /** @namespace eth */ /** @custom xxx */ 'use strict'; var Exceptions, xcatalog, moment, xreq = require('xreq'), Validator = xreq.utils('Validator'); /** @module contract */ /** @custom xxx */ class ContractService { /** * Service that will handle payments lifecycle * @param {Object} &quot;exceptions&quot; - DI for exceptions * @constructor * @returns {Object} Returns a new ContractService service object. */ constructor (catalog, moment, i18n, enume, exceptions, contractModel) { Exceptions = exceptions; xcatalog = catalog; moment = moment; this.i18n = i18n; this.model = contractModel; this.enume = enume; } /** * Deploys a new contract in the Ethereum blockchain. * @memberOf EthContractService * @param {string} contract Contract name * @param {string} sender Address of the sender, if null it will use the default one * @param {boolean} wait If set to true it will wait until the contract is mined. If not it will return the transactionHash straight away and some other process will have to monitor the status. * @custom public * @returns {string} Returns the transaction hash id of the contract deployment */ deployContract(contract,sender,wait) { let itself = this; return new Promise(function (resolve, reject) { var validator = new Validator({ contract : contract, wait: wait}); validator.path('contract', ['string', 'required']); validator.path('wait', ['boolean', 'required']); if (validator.hasErrors()) { let vErrors = validator.getErrors(); reject(new Exceptions.Validation(vErrors) ); return; } else { return itself.model.deployContract(contract,sender,wait) .then(function(response){ resolve(response); },function(err){ reject(err); }) .catch(function(err){ reject(err); }); } }); } /** * Sends coins from the coinbase to the passed account. * @memberOf EthContractService * @param {string} contractAddress Contract's address. * @param {string} receiverAddress Address to receive the coins. * @param {string} value Number of coins to transfer. * @custom public */ contractCall(contract,from,data,wait,local,method) { let itself = this; const validator = new Validator({ from: from, wait : wait, contract: contract, method: method, data: data, local: local }); validator.path('contract', ['string', 'required']); validator.path('method', ['string', 'required']); validator.path('data', ['required']); validator.path('wait', ['boolean','required']); validator.path('local', ['boolean','required']); return new Promise(function (resolve, reject) { if (validator.hasErrors()) { let vErrors = validator.getErrors(); reject(new Exceptions.Validation(vErrors) ); return; } else { return itself.model.sendTransaction(contract,from,data,wait,local,method) .then(function(response){ resolve(response); },function(err){ reject(err); }) .catch(function(err){ reject(err); }); } }); } } module.exports = ContractService; × Search results Close "},"eth_account_AccountService.js.html":{"id":"eth_account_AccountService.js.html","title":"Source: eth/account/AccountService.js","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Source: eth/account/AccountService.js /*jslint node: true*/ /** @namespace eth */ /** @custom xxx */ 'use strict'; var Exceptions, xcatalog, moment, xreq = require('xreq'), Validator = xreq.utils('Validator'); /** @module account */ /** @custom xxx */ class AccountService { /** * Service that will handle acount lifecycle * @param {Object} &quot;exceptions&quot; - DI for exceptions * @constructor * @returns {Object} Returns a new AccountService service object. */ constructor (catalog, moment, i18n, enume, exceptions, accountModel) { Exceptions = exceptions; xcatalog = catalog; moment = moment; this.i18n = i18n; this.model = transactionModel; this.enume = enume; } /** * Gets account details. * @memberOf EthAccService * @param {trxhash} trxhash Transaction identifier * @custom public */ get(trxhash) { let itself = this; return new Promise(function (resolve, reject) { return itself.model.get(trxhash) .then(function(response){ if (response) { resolve(response); } else { reject('Transaction not found'); } },function(err){ reject(err); }) .catch(function(err){ reject(err); }); }); } } module.exports = AccountService; × Search results Close "},"eth_transaction_TransactionService.js.html":{"id":"eth_transaction_TransactionService.js.html","title":"Source: eth/transaction/TransactionService.js","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Source: eth/transaction/TransactionService.js /*jslint node: true*/ /** @namespace eth */ /** @custom xxx */ 'use strict'; var Exceptions, xcatalog, moment, xreq = require('xreq'), Validator = xreq.utils('Validator'); /** @module transaction */ /** @custom xxx */ class TransactionService { /** * Service that will handle payments lifecycle * @param {Object} &quot;exceptions&quot; - DI for exceptions * @constructor * @returns {Object} Returns a new TransactionService service object. */ constructor (catalog, moment, i18n, enume, exceptions, transactionModel) { Exceptions = exceptions; xcatalog = catalog; moment = moment; this.i18n = i18n; this.model = transactionModel; this.enume = enume; } /** * Checks whether the Ethereum node is up and running or not. * @memberOf EthTrxService * @param {string} name Contract name. For example. 'MyCoin'. * @custom public */ get(trxhash) { let itself = this; return new Promise(function (resolve, reject) { return itself.model.get(trxhash) .then(function(response){ if (response) { resolve(response); } else { reject('Transaction not found'); } },function(err){ reject(err); }) .catch(function(err){ reject(err); }); }); } } module.exports = TransactionService; × Search results Close "},"eth_transaction_TransactionModel.js.html":{"id":"eth_transaction_TransactionModel.js.html","title":"Source: eth/transaction/TransactionModel.js","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Source: eth/transaction/TransactionModel.js /*jslint node: true*/ /*globals Promise: true*/ /** @namespace eth */ /** @custom xxx */ 'use strict'; var xreq = require('xreq'), helpers = xreq.helpers('modelHelpers'), ObjectID = require('mongodb').ObjectID; /** @module transaction */ /** @custom xxx */ class TransactionModel { /** * Model to handle the transactions collection * @param {Object} &quot;db&quot; - DI for database * @param {Object} &quot;i18n&quot; - DI for i18n * @param {Object} &quot;enume&quot; - DI for enum * @param {Object} &quot;moment&quot; - DI for moment * @param {Object} &quot;config&quot; - DI for config * @param {Object} &quot;ethHelper&quot; - DI for ethHelper * @constructor * @returns {Object} Returns a new TransactionModel object. */ constructor (i18n, enume, moment, config, ethHelper) { //this.collection = db.collection(&quot;contracts&quot;); this.i18n = i18n; this.contract = {}; this.enum = enume; this.moment = moment; this.config = config; this.ethHelper = ethHelper; } /** * Returns the transaction detail for a certain id * @public * @memberOf TransactionModel * @param {string} trxhash Transaction identifier * @custom public * @returns {Promise} Returns a new promise with the transaction detail. */ get (trxhash) { const ethHelp = this.ethHelper; return new Promise(function (resolve, reject) { ethHelp.util.status().then(function(result){ ethHelp.trx.get(trxhash) .then(function (result) { resolve(result); }) .catch(function (error) { reject(error); }); }).catch(function (error) { reject(error); }); }); } } module.exports = TransactionModel; × Search results Close "},"util_lcd.js.html":{"id":"util_lcd.js.html","title":"Source: util/lcd.js","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Source: util/lcd.js var i2c = require('i2c'); var sleep = require('sleep'); // LCD i2c interface via PCF8574P // http://dx.com/p/lcd1602-adapter-board-w-iic-i2c-interface-black-works-with-official-arduino-boards-216865 // https://gist.github.com/chrisnew/6725633 // http://www.espruino.com/HD44780 // http://www.espruino.com/LCD1602 var displayPorts = { RS : 0x01, E : 0x04, D4 : 0x10, D5 : 0x20, D6 : 0x40, D7 : 0x80, CHR : 1, CMD : 0, backlight : 0x08, RW : 0x20 // not used }; var LCD = function (device, address) { this.i2c = new i2c(address, { device : device }); this.write4(0x30, displayPorts.CMD); //initialization this._sleep(200); this.write4(0x30, displayPorts.CMD); //initialization this._sleep(100); this.write4(0x30, displayPorts.CMD); //initialization this._sleep(100); this.write4( LCD.FUNCTIONSET | LCD._4BITMODE | LCD._2LINE | LCD._5x10DOTS, displayPorts.CMD); //4 bit - 2 line 5x7 matrix this._sleep(10); this.write(LCD.DISPLAYCONTROL | LCD.DISPLAYON, displayPorts.CMD); //turn cursor off 0x0E to enable cursor this._sleep(10); this.write(LCD.ENTRYMODESET | LCD.ENTRYLEFT, displayPorts.CMD); //shift cursor right this._sleep(10); this.write(LCD.CLEARDISPLAY, displayPorts.CMD); // LCD clear return this; } // commands LCD.CLEARDISPLAY = 0x01; LCD.RETURNHOME = 0x02; LCD.ENTRYMODESET = 0x04; LCD.DISPLAYCONTROL = 0x08; LCD.CURSORSHIFT = 0x10; LCD.FUNCTIONSET = 0x20; LCD.SETCGRAMADDR = 0x40; LCD.SETDDRAMADDR = 0x80; //# flags for display entry mode LCD.ENTRYRIGHT = 0x00; LCD.ENTRYLEFT = 0x02; LCD.ENTRYSHIFTINCREMENT = 0x01; LCD.ENTRYSHIFTDECREMENT = 0x00; //# flags for display on/off control LCD.DISPLAYON = 0x04; LCD.DISPLAYOFF = 0x00; LCD.CURSORON = 0x02; LCD.CURSOROFF = 0x00; LCD.BLINKON = 0x01; LCD.BLINKOFF = 0x00; //# flags for display/cursor shift LCD.DISPLAYMOVE = 0x08; LCD.CURSORMOVE = 0x00; LCD.MOVERIGHT = 0x04; LCD.MOVELEFT = 0x00; //# flags for function set LCD._8BITMODE = 0x10; LCD._4BITMODE = 0x00; LCD._2LINE = 0x08; LCD._1LINE = 0x00; LCD._5x10DOTS = 0x04; LCD._5x8DOTS = 0x00; LCD.prototype._sleep = function (milli) { sleep.usleep(milli * 1000); }; LCD.prototype.write4 = function (x, c) { function err() {}; var a = (x &amp; 0xF0); // Use upper 4 bit nibble this.i2c.writeByte(a | displayPorts.backlight | c, err); this.i2c.writeByte(a | displayPorts.E | displayPorts.backlight | c, err); this.i2c.writeByte(a | displayPorts.backlight | c, err); this._sleep(1); } LCD.prototype.write = function (x, c) { this.write4(x, c); this.write4(x &lt;&lt; 4, c); this._sleep(1); return this; } LCD.prototype.clear = function () { return this.write(LCD.CLEARDISPLAY, displayPorts.CMD); } LCD.prototype.print = function (str) { if (typeof str == 'string') { for (var i = 0; i &lt; str.length; i++) { var c = str[i].charCodeAt(0); this.write(c, displayPorts.CHR); this._sleep(1); } } return this; } /** flashing block for the current cursor */ LCD.prototype.cursorFull = function () { return this.write(LCD.DISPLAYCONTROL | LCD.DISPLAYON | LCD.CURSORON | LCD.BLINKON, displayPorts.CMD); } /** small line under the current cursor */ LCD.prototype.cursorUnder = function () { return this.write(LCD.DISPLAYCONTROL | LCD.DISPLAYON | LCD.CURSORON | LCD.BLINKOFF, displayPorts.CMD); } /** set cursor pos, top left = 0,0 */ LCD.prototype.setCursor = function (x, y) { var l = [0x00, 0x40, 0x14, 0x54]; return this.write(LCD.SETDDRAMADDR | (l[y] + x), displayPorts.CMD); } /** set cursor to 0,0 */ LCD.prototype.home = function () { var l = [0x00, 0x40, 0x14, 0x54]; return this.write(LCD.SETDDRAMADDR | 0x00, displayPorts.CMD); } /** Turn underline cursor off */ LCD.prototype.blinkOff = function () { return this.write( LCD.DISPLAYCONTROL | LCD.DISPLAYON | LCD.CURSOROFF | LCD.BLINKOFF, displayPorts.CMD); } /** Turn underline cursor on */ LCD.prototype.blinkOn = function () { return this.write( LCD.DISPLAYCONTROL | LCD.DISPLAYON | LCD.CURSORON | LCD.BLINKOFF, displayPorts.CMD); } /** Turn block cursor off */ LCD.prototype.cursorOff = function () { return this.write( LCD.DISPLAYCONTROL | LCD.DISPLAYON | LCD.CURSOROFF | LCD.BLINKON, displayPorts.CMD); } /** Turn block cursor on */ LCD.prototype.cursorOn = function () { return this.write( LCD.DISPLAYCONTROL | LCD.DISPLAYON | LCD.CURSORON | LCD.BLINKON, displayPorts.CMD); } /** setBacklight */ LCD.prototype.setBacklight = function (val) { if (val &gt; 0) { displayPorts.backlight = 0x08; } else { displayPorts.backlight = 0x00; } return this.write(LCD.DISPLAYCONTROL, displayPorts.CMD); } /** setContrast stub */ LCD.prototype.setContrast = function (val) { return this.write(LCD.DISPLAYCONTROL, displayPorts.CMD); } /** Turn display off */ LCD.prototype.off = function () { displayPorts.backlight = 0x00; return this.write(LCD.DISPLAYCONTROL | LCD.DISPLAYOFF, displayPorts.CMD); } /** Turn display on */ LCD.prototype.on = function () { displayPorts.backlight = 0x08; return this.write(LCD.DISPLAYCONTROL | LCD.DISPLAYON, displayPorts.CMD); } /** set special character 0..7, data is an array(8) of bytes, and then return to home addr */ LCD.prototype.createChar = function (ch, data) { this.write(LCD.SETCGRAMADDR | ((ch &amp; 7) &lt;&lt; 3), displayPorts.CMD); for (var i = 0; i &lt; 8; i++) this.write(data[i], displayPorts.CHR); return this.write(LCD.SETDDRAMADDR, displayPorts.CMD); } module.exports = LCD; × Search results Close "},"struct_Response.js.html":{"id":"struct_Response.js.html","title":"Source: struct/Response.js","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Source: struct/Response.js 'use strict'; const e = require('./../../../lib/enum'); /** Creates a new Response object. @constructor */ function Response(status,code,data,message,error) { /** Initialization */ /** * Code of the response * @type {collection} */ if (error) { this.body = { status: status, error: { code: (error.code) ? error.code : e.http.status.internalerror, type: error.type, message: error.message } }; } else { this.body = { status: status, code: code, message: message }; } if (data) { this.body.data = data; } } /** Get response body */ Response.prototype.getData = function() { return this.body.data; }; /** Get code */ Response.prototype.getCode = function() { return this.body.code; }; /** Get Message */ Response.prototype.getMessage = function() { return this.body.message; }; /** Get Error */ Response.prototype.getStatus = function() { return this.body.status; }; /** Export the class */ module.exports = Response; × Search results Close "},"exception_ServerExceptions.js.html":{"id":"exception_ServerExceptions.js.html","title":"Source: exception/ServerExceptions.js","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Source: exception/ServerExceptions.js /*jslint node: true*/ &quot;use strict&quot;; class ServerExceptions { /** * Class that will handle Restify exceptions * @param {Object} &quot;i18n&quot; - DI for i18n * @param {Object} &quot;restify&quot; - DI for restify * @param {Object} &quot;logger&quot; - DI for logger * @param {Object} &quot;util&quot; - DI for util * @param {Object} &quot;exceptions&quot; - DI for exceptions * @constructor * @returns {Object} Returns a new ServerExceptions object. */ constructor ( i18n, restify, logger, util, exceptions) { this.i18n = i18n; this.restify = restify; this.logger = logger; this.util = util; this.exceptions = exceptions; //this.util.inherits(this.restify.RestError); } /** * Generates a new restify exception based on err instance * @public * @memberOf ServerExceptions * @param {object} error, Error object * @custom public * @example &lt;caption&gt;Error types:&lt;/caption&gt; * Base: ServiceException, * AccessDenied: AccessDeniedException, * NotFound: NotFoundException, * Validation: ValidationException, * Internal: InternalException * @returns {object} Returns a new restify exception object. */ createException (error, req){ if(error instanceof this.exceptions.Validation){ req.log.debug('Validation error: %s', error); return new this.restify.InvalidArgumentError( this.i18n.__('ValidationError') + ' '+ this.util.inspect(error.errors) ); } if(error instanceof this.exceptions.AccessDenied){ req.log.debug('The access was denied to the resoruce you are trying to access %s', error); return new this.restify.NotAuthorizedError( this.i18n.__('AccessDeniedError') + ' '+ this.util.inspect(error) ); } if(error instanceof this.exceptions.NotFound){ req.log.warn('Resouce not found exception: %s', error); return new this.restify.ResourceNotFoundError ( this.i18n.__('NotFoundError') + &quot; on &quot; + error.collection + &quot; &quot; + error.resource ); } if(error instanceof this.exceptions.Internal){ req.log.info('There was an internal server error %s', error); return new this.restify.InternalServerError( this.i18n.__('InternalError') + ' '+ this.util.inspect(error) ); } if(error instanceof this.exceptions.Base){ req.log.info('There was a problem processing your request %s', error); return new this.restify.InternalServerError( this.i18n.__('BaseError') + ' '+ this.util.inspect(error) ); } req.log.info('There was an internal server error %s', error); return new this.restify.InternalServerError( this.i18n.__('OtherError') + ' '+ this.util.inspect(error) ); } createServerErrorException (errors, req){ req.log.info('There was an internal server error %s', errors); return new this.restify.InternalServerError( this.i18n.__('OtherError') + ' '+ this.util.inspect(errors) ); } createValidationException (errors, req){ req.log.debug('Validation error: %s', errors); return new this.restify.InvalidArgumentError( this.i18n.__('ValidationError') + ' '+ this.util.inspect(errors) ); } createInvalidCredentialsException(errors, req){ req.log.debug('InvalidCredentialsError: %s', errors.toString()); return new this.restify.InvalidCredentialsError( errors.toString() ); } logException (error){ } /** * Returns the error type (instanceof or constructor name) * @public * @memberOf ServerExceptions * @param {object} error, Error object * @custom public * @returns {string} instanceof or constructor name. */ getExceptionInstanceOf (error){ if(error instanceof this.exceptions.Validation) return &quot;ValidationException&quot;; if(error instanceof this.exceptions.AccessDenied) return &quot;AccessDeniedException&quot;; if(error instanceof this.exceptions.NotFound) return &quot;NotFoundException&quot;; if(error instanceof this.exceptions.Internal) return &quot;InternalException&quot;; if(error instanceof this.exceptions.Base) return &quot;ServiceException&quot;; return error.constructor.name; } } module.exports = ServerExceptions; × Search results Close "},"server.js.html":{"id":"server.js.html","title":"Source: server.js","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Source: server.js /*jslint node: true*/ 'use strict'; const YES = 'yes', ROUTER = 'Router', AUDIT = 'AUDIT', LOG = 'LOG', PREFIX_API = '/api', request = require('request'), rc = require('restify-conductor'), semver = require('semver'), auditlogger = require('bunyan') ; /** * Service that will manage the creation of new API servers * @param {Object} 'restify' - DI for restify * @param {Object} 'logger' - DI for logger * @param {Object} 'util' - DI for util * @param {Object} 'app_name' - DI for app_name * @param {Object} 'app_version' - DI for app_version * @constructor * @returns {Object} Returns a new ServerSetup service object. */ function ServerSetup(restify, logger, util, xcatalog, app_name, app_version, exceptions) { // Service has to be called as contained dependency not as isolated function if (!(this instanceof ServerSetup)) { throw new Error('Used as a function'); } this.restify = restify; this.logger = logger; this.util = util; this.xcatalog = xcatalog; this.app_name = app_name; this.app_version = app_version; this.exceptions = exceptions; } /** * @public * @memberOf ServerSetup * @param {Object} 'config' - Configuration object for the new API server * @example &lt;caption&gt;Example usage of createAPIServer&lt;/caption&gt; * var server = serverSetup.createAPIServer(config); * @returns {Object} Returns a new API server. */ ServerSetup.prototype.createAPIServer = function(config) { var config = config; var restify = this.restify; var logger = this.logger; var util = this.util; var xcatalog = this.xcatalog; var app_name = this.app_name; var app_version = this.app_version; var exceptions = this.exceptions; var server; /** * @private * @memberOf ServerSetup * Applies API global headers to avoid caching * @returns {Void} */ var noCacheMiddleware = function noCacheMiddleware(req, res, next) { res.header('Cache-Control', 'no-cache, no-store, must-revalidate'); res.header('Pragma', 'no-cache'); res.header('Expires', 0); next(); } /** * @private * @memberOf ServerSetup * Sets up all api routes in the new API server * @returns {Void} */ var setupPreHandlers = function setupPreHandlers () { server.pre(restify.pre.sanitizePath()); server.pre(function (req, res, next) { req.url = req.url.replace(PREFIX_API, ''); var pieces = req.url.replace(/^\\/+/, '').split('/'); var version = pieces[0]; version = version.replace(/v(\\d{1})\\.(\\d{1})\\.(\\d{1})/, '$1.$2.$3'); version = version.replace(/v(\\d{1})\\.(\\d{1})/, '$1.$2.0'); version = version.replace(/v(\\d{1})/, '$1.0.0'); if (semver.valid(version)) { req.url = req.url.replace(pieces[0], ''); req.headers = req.headers || []; req.headers['accept-version'] = version; } else { if (req.url!='/') { return next(new restify.InvalidVersionError('This is an invalid version')); } } next(); }); return; } /** * @private * @memberOf ServerSetup * Sets up all API routes in the new API server * @returns {Void} */ var setupRoutes = function setupRoutes () { config.routers.map( item =&gt; xcatalog(item + 'Router') ) return; } /** * @private * @memberOf ServerSetup * Sets up parsing, zipping, logging,... * @returns {Void} */ var setupUses = function use () { server.use(restify.acceptParser(server.acceptable )); server.use(restify.queryParser()); server.use(restify.bodyParser()); server.use(restify.gzipResponse()); server.use(restify.fullResponse()); server.use(restify.requestLogger({})); server.use(noCacheMiddleware); return; } /** * @private * @memberOf ServerSetup * Sets up a root route for heartbeat * @returns {Void} */ var setUpHeartBeat = function setUpHeartBeat () { var heartbeatConductor = rc.createConductor({ name: 'heartbeatConductor', handlers: [ function render(req, res, next) { res.json( {name: app_name , version: app_version , date: new Date() }); return next(); } ] }); rc.get('/', heartbeatConductor, server); return; } /** * @private * @memberOf ServerSetup * Sets up an auditer instance to write audit logs * @returns {Void} */ var setUpAuditer = function setUpAuditer () { server.on('after', restify.auditLogger({ log: auditlogger.createLogger({ name: app_name + AUDIT, streams: [{ type: 'rotating-file', path: './'+ config.log.path +'/'+ app_name +'_'+ AUDIT +'.log', period: config.log.rotation_period, // daily rotation count: config.log.back_copies_count // back copies }] }) })); return; } /** * @private * @memberOf ServerSetup * Sets up a static server for documentation files * @returns {Void} */ var setUpStaticDocServer = function setUpStaticDocServer () { server.get(/\\/docs\\/v1\\/?.*/, restify.serveStatic({ directory: __dirname + '../../../', default: 'index.html' })) } /** * @private * @memberOf ServerSetup * Sets up a static server for swagger files * @returns {Void} */ var setUpSwaggerServer = function setUpSwaggerServer () { server.get(/\\/swagger\\/dist\\/?.*/, restify.serveStatic({ directory: __dirname + '../../../', default: 'index.html' })) } /** * @private * @memberOf ServerSetup * Returns a formatted json object for error response * @returns {Object} body object for the json response */ var formartErrorResponse = function formartErrorResponse (body) { let message = (body.message === '')?body.we_cause:body.message; let error = null; if(message instanceof Error){ if(message.name) message = 'Error: '+ message.name; if(body.name) message += ' '+ body.name; } let doc = { status: 'error', message: message, code: body.statusCode, body: body.body }; if(body.restCode){ doc.restCode = body.restCode } if(body.name){ doc.name = body.name } if(doc.body.message === '') doc.body.message = message; if(doc.message === '') doc.message = message; return doc; } /** * @private * @memberOf ServerSetup * Returns a formatted json object for standard response * @returns {Object} body object for the json response */ var formartResponse = function formartResponse (body) { return body = { code: 200, status: 'success', body: body }; } /** * @private * @memberOf ServerSetup * Returns global formatters for json I/O * @returns {Object} json object for the response formatters */ var getJsonFormaters = function getJsonFormaters () { return { 'application/json': function formatJson(req, res, body, cb) { //error response formatter if (body instanceof Error){ return cb(null, util.inspect(formartErrorResponse(body))); } if (Buffer.isBuffer(body)){ return cb(null, formartResponse(body)); } return cb(null, JSON.stringify(formartResponse(body), null, 2)); } } } /** * @private * @memberOf ServerSetup * Returns a configuration object for restify server start up based on config * @returns {Object} Returns a server properties object. */ var createServerPropObject = function createServerPropObject (config, name, version) { // base object for any of the 2 allowed protocols var oServerProp = { name: name, version: version, formatters: getJsonFormaters() }; // set up certs if HTTPS server if(config.protocol === 'HTTPS'){ //Adding certs for secure server if (config.tsl.cert) oServerProp.certificate = fs.readFileSync(this.config.tsl.cert); if (config.tsl.key) oServerProp.key = fs.readFileSync(this.config.tsl.key); } // if logging enabled, create a new logger instance if(config.log.enabled === true){ oServerProp.log = logger.createLogger({ name: app_name + LOG, streams: [{ type: 'rotating-file', src: true, path: './'+ config.log.path +'/'+ app_name +'_'+ LOG +'.log', period: config.log.rotation_period, // daily rotation count: config.log.back_copies_count // back copies }], level: config.log.level }); } oServerProp.log.info('Server started with log level %s', config.log.level); return oServerProp; } /** * @private * @memberOf ServerSetup * Applies septup sections based on config * @returns {Object} Returns a restify server object. */ var configServer = function configServer(){ // handlers that run before routing occurs setupPreHandlers(); // Common api calls handlers setupUses(); //Define heartbeat routes setUpHeartBeat(); //Add all routes setupRoutes(); //If audit requested, enable auditer if(config.log.audit === YES) setUpAuditer(); if (config.documentation.enabled === true) { setUpStaticDocServer(); setUpSwaggerServer(); } //When server is ready, start it up startServer(); return server; } /** * @private * @memberOf ServerSetup * Starts a newly created API server to listen in configured port * @returns {Promise} Returns a promise that will be resolved when server is listening. */ var startServer = function startServer () { return server.listen(config.port, function () { console.log(config.protocol + ' Server listening on port: ' + config.port); }); } /** * @private * @memberOf ServerSetup * Creates a new API server (protocol based) and configures it * @returns {Object} Returns a restify server object to be configured and started. */ var createServer = function createServer () { if (config.protocol === 'HTTPS') { server = restify.createServer(createServerPropObject(config, app_name, app_version)); xcatalog.set('apiserver', 'constant', server); configServer(server); } else if (config.protocol === 'HTTP') { server = restify.createServer(createServerPropObject(config, app_name, app_version)); xcatalog.set('apiserver', 'constant', server); configServer(server); } else { throw new TypeError('Missing protocol or invalid value: ' + config.protocol); } return server; } return createServer(server); } module.exports = ServerSetup; × Search results Close "},"util_Validator.js.html":{"id":"util_Validator.js.html","title":"Source: util/Validator.js","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Source: util/Validator.js /*jslint node: true*/ 'use strict'; const moment = require('moment'); class Validator { constructor (obj, prop) { this.obj = obj; this.errors = []; this.props = []; } push (path, constrain, value) { this.errors.push({ path: path, constrain: constrain, value: value }); } getErrors () { return this.errors.concat(this.props.reduce(function (result, prop) { prop.ref.getErrors().forEach(function (error) { result.push({ path: prop.path + '.' + error.path, constrain: error.constrain, value: error.value }); }); return result; }, [])); } hasErrors () { return !!this.errors.length || this.props.some((prop) =&gt; prop.ref.hasErrors()); } prop (prop) { let validator = new Validator(this.obj[prop]); this.props.push({ path: prop, ref: validator }); return validator; } /** * Validate a path. * required: default true; */ path (path, methods, required) { let itself = this, value = this.obj[path]; required = (required !== false); if (!Validator.required(value)) { if (required) { itself.push(path, 'required', value); } return !required; } return methods.every(function (method) { var result = Validator.validate(method, value); if (!result) { itself.push(path, method, value); } return result; }); } arraypath (path, methods, required) { let itself = this, values = this.obj[path]; required = (required !== false); return values.every(function (value, index) { if (!Validator.required(value)) { if (required) { itself.push(path + '[' + index + ']', 'required', value); } return !required; } return methods.every(function (method) { let result = Validator.validate(method, value); if (!result) { itself.push(path + '[' + index + ']', method, value); } return result; }); }); } } /* Validation methods */ Validator.isoDate = (str) =&gt; moment(str, 'YYYY-MM-DD', true).isValid(); Validator.gte = (a, value) =&gt; value &gt;= a; Validator.lte = (a, value) =&gt; value &lt;= a; Validator.gt = (a, value) =&gt; value &gt; a; Validator.lt = (a, value) =&gt; value &lt; a; Validator.enum = (list, value) =&gt; list.indexOf(value) !== -1; Validator.string = (value) =&gt; typeof value === 'string'; Validator.minLength = (min, value) =&gt; value.length &gt;= min; Validator.maxLength = (max, value) =&gt; value.length &lt;= max; Validator.equal = (expected, value) =&gt; expected === value; Validator.number = (value) =&gt; typeof value === 'number'; Validator.boolean = (value) =&gt; typeof value === 'boolean'; Validator.array = (value) =&gt; Array.isArray(value); Validator.noDuplicates = (values) =&gt; values.every( (value, index, array) =&gt; array.indexOf(value) === index ); /*jslint bitwise: true*/ Validator.integer = (value) =&gt; value === +value &amp;&amp; value === (value | 0); /*jslint bitwise: false*/ Validator.range = (min, max, value) =&gt; value &gt;= min &amp;&amp; value &lt;= max; Validator.required = (value) =&gt; value !== undefined &amp;&amp; !Number.isNaN(value) &amp;&amp; value !==null; Validator.notNaN = (value) =&gt; !Number.isNaN(value); Validator.undefined = (value) =&gt; value === undefined; Validator.pattern = (re, value) =&gt; re.test(value); Validator.validate = function (method, value) { let result; if (Array.isArray(method)) { //Better performance than apply switch (method.length) { case 2: result = Validator[method[0]](method[1], value); break; case 3: result = Validator[method[0]](method[1], method[2], value); break; default: throw new TypeError('Invalid number of arguments'); } } else if (typeof method === 'string') { result = Validator[method](value); } else { throw new TypeError('Invalid method type'); } return result; }; module.exports = Validator; × Search results Close "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Modules Classes AccountModel AccountService ContractModel ContractService LockerModel LockerService TransactionModel TransactionService Response ServerExceptions ServerSetup Namespaces eth eth eth eth eth eth eth eth × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Classes Classes AccountModel AccountService ContractModel ContractService LockerModel LockerService TransactionModel TransactionService Response ServerExceptions ServerSetup Namespaces eth eth eth eth eth eth eth eth × Search results Close "},"namespaces.list.html":{"id":"namespaces.list.html","title":"Namespaces","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Namespaces Classes AccountModel AccountService ContractModel ContractService LockerModel LockerService TransactionModel TransactionService Response ServerExceptions ServerSetup Namespaces eth eth eth eth eth eth eth eth × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Middleware nodejs piece that interfaces with the Ethereum RPC Api. Version0.0.2 TechPrerequisites node.js &gt; 4.x git Deployment checklist Install or update prerequisites (Only once) Download the source (Only once) Set environment Checkout a tag/version Configure app (certificates, secrets for enviromnent...) Install dependencies Start the app DownloadFor deployment (read only, public access) git cloneFor development (full access, auth. users) git cloneCheckout an specific tagExecute this commands in the app folder git fecth # update local repository git checkout v1.0.0 # checkout version v1.0.0Set environmentChoose one: # Local development export NODE_ENV=development #MACPRO-DEV export NODE_ENV=development # Preproduction and pilot export NODE_ENV=preproduction # Production and pre-production export NODE_ENV=productionInstall dependenciesChoose one: # Without proxy npm install # Proxy HTTP_PROXY=http://your-proxy:8080 npm installThis process also execute build after install all the dependencies Setup and data migration(This is no required, It is done by npm install post hook) Choose one: npm run setupWARNING: setup must be executed with the same environment as the application process. Service testsEnvironment should be set at this point npm testStart serverChoose one: #Local development - monitor server changes and restart nodemon # Install it with &quot;npm install -g nodemon&quot; #local UI development npm start #Audit can be enabled by changing default value for &quot;audit&quot; in configuration filesCreating a new node in private network Create a folder and place a genesis.json inside it containing the following: { &quot;nonce&quot;: &quot;0x0000000000000042&quot;, &quot;timestamp&quot;: &quot;0x0&quot;, &quot;parentHash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;extraData&quot;: &quot;0x0&quot;, &quot;gasLimit&quot;: &quot;0x8000000&quot;, &quot;difficulty&quot;: &quot;0x400&quot;, &quot;mixhash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;, &quot;coinbase&quot;: &quot;0x3333333333333333333333333333333333333333&quot;, &quot;alloc&quot;: { } } Run geth --datadir &lt;created folder&gt; init &lt;created folder&gt;/genesis.json. This will create a chaindata folder. Create a new account with geth --datadir &lt;created folder&gt; account new. You can issue this command as much times as accounts are needed. For the needs of the PoC the accounts needn't have passwords. Created accounts can be listed using geth --datadir &lt;created folder&gt; account list. Start the node usinggeth --datadir &lt;created folder&gt; --networkid 123 --ipcpath &lt;created folder&gt;/geth.ipc --nodiscover --solc solc --rpc --rpccorsdomain &quot;*&quot; --unlock 0,1 console. If it's a mining node --mine --minerthreads 2 can be appended. If you need to run multiple nodes on the same machine they should have different discovery and RPC ports. This is done by appending --port 30304 --rpcport 8546 to the above command. Set up node discovery In order for a node to connect to others in our network, we need to setup a static-nodes.json file in the working directory. Get all of the nodes ID URIs by issuing the admin.nodeInfo.enode command in each node's console. Then add the node URIs of the particular nodes that you'd like your node to connect to as strings in an array: [ &quot;enode://be03340ed41e08f0387f5f4b5418eae6b890d56685c397b4ece438b2de346d41e6aa885594336f079d56199864391d11a81fb4fbf819dde2cfecf100e016acc6@10.42.0.108:30303&quot;, &quot;enode://648685ddaf45bc6799a30114c1402884e64c503ec04792e2fb9de05aee4f8b1de6fe62253ccea39088ed0090573fb69ff6fb2fce2ec22b5b80e5d25fa812ede9@127.0.0.1:30304&quot; ]Ethereum node detailsStefan-Laptop miner 1Command to start itNode URIenode://583bd7834f8a27b8bb213c6bfc413fc08c350b55dc882c27e090364044b11b3d4c2effbaa10ab0d6edd6e0676dcfee5022bace095dd45dc2426c4d3089c30649@10.42.0.165:30303 Accounts 0x40ead8d2363fbad416ee0f156a922dcad52ce321 (etherbase) 0x0351b5f592c5cf37bb277a9d55e97ffacd08b990 0x4fe5a35c4cf3d09dc7cf9eb311d9e315b6ef8812 Stefan-Laptop miner 2Node URIenode://188b5c92fde85f22e7e18af703d4976d4024ceeeeb61f50e1a2ec09cf4adff622ba8591866d741b22c7e472bba7ae8e6007df854bbd6186ec83f05c6bafd5a06@10.42.0.165:30304 Accounts 0x0491615b945056a0a2015ca5678971628fa00fbe (etherbase) Smart locker non-minerNode URIenode://be03340ed41e08f0387f5f4b5418eae6b890d56685c397b4ece438b2de346d41e6aa885594336f079d56199864391d11a81fb4fbf819dde2cfecf100e016acc6@10.42.0.108:30303 Accounts 0xf521e52133f9668b2fb22a8778452e82c34595bd 0x459a7db5b046455817750cdb5be67b081ed6e33d Contract creation logRunning migration: 1_initial_migration.js Deploying Migrations... Migrations: 0x7193bbb44a148ec2760243ebe151ac4831814a4e Saving successful migration to network... Saving artifacts... Running migration: 2_deploy_contracts.js Deploying BlockDatesLib... BlockDatesLib: 0xdea5c1ba932812025067684f6236fdbce243f64a Linking BlockDatesLib to Lock Deploying Lock... Lock: 0x3bfe60eb4bbf455f564a70d74c9a40dc3e11566d Saving successful migration to network... Saving artifacts... × Search results Close "},"eth.html":{"id":"eth.html","title":"Namespace: eth","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Namespace: eth eth Source: eth/locker/LockerModel.js, line 3 Namespace: eth eth Source: eth/locker/LockerService.js, line 2 Namespace: eth eth Source: eth/contract/ContractModel.js, line 3 Namespace: eth eth Source: eth/account/AccountModel.js, line 3 Namespace: eth eth Source: eth/contract/ContractService.js, line 2 Namespace: eth eth Source: eth/account/AccountService.js, line 2 Namespace: eth eth Source: eth/transaction/TransactionService.js, line 2 Namespace: eth eth Source: eth/transaction/TransactionModel.js, line 3 × Search results Close "},"module-account.html":{"id":"module-account.html","title":"Module: account","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Module: account Source: eth/account/AccountModel.js, line 12 Classes AccountModel AccountService Module: account Source: eth/account/AccountService.js, line 14 Classes AccountModel AccountService × Search results Close "},"module-account-AccountModel.html":{"id":"module-account-AccountModel.html","title":"Class: AccountModel","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Class: AccountModel account~ AccountModel new AccountModel(&quot;db&quot;, &quot;i18n&quot;, &quot;enume&quot;, &quot;moment&quot;, &quot;config&quot;, &quot;ethHelper&quot;) Model to handle the accounts collection Parameters: Name Type Description &quot;db&quot; Object DI for database &quot;i18n&quot; Object DI for i18n &quot;enume&quot; Object DI for enum &quot;moment&quot; Object DI for moment &quot;config&quot; Object DI for config &quot;ethHelper&quot; Object DI for ethHelper Source: eth/account/AccountModel.js, line 14 × Search results Close "},"module-account-AccountService.html":{"id":"module-account-AccountService.html","title":"Class: AccountService","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Class: AccountService account~ AccountService new AccountService(&quot;exceptions&quot;) Service that will handle acount lifecycle Parameters: Name Type Description &quot;exceptions&quot; Object DI for exceptions Source: eth/account/AccountService.js, line 16 × Search results Close "},"module-contract.html":{"id":"module-contract.html","title":"Module: contract","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Module: contract Source: eth/locker/LockerService.js, line 14 Classes ContractModel ContractService LockerModel LockerService Module: contract Source: eth/locker/LockerModel.js, line 12 Classes ContractModel ContractService LockerModel LockerService Module: contract Source: eth/contract/ContractService.js, line 14 Classes ContractModel ContractService LockerModel LockerService Module: contract Source: eth/contract/ContractModel.js, line 12 Classes ContractModel ContractService LockerModel LockerService × Search results Close "},"module-contract-ContractModel.html":{"id":"module-contract-ContractModel.html","title":"Class: ContractModel","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Class: ContractModel contract~ ContractModel new ContractModel(&quot;db&quot;, &quot;i18n&quot;, &quot;enume&quot;, &quot;moment&quot;, &quot;config&quot;, &quot;ethHelper&quot;) Model to handle the contracts collection Parameters: Name Type Description &quot;db&quot; Object DI for database &quot;i18n&quot; Object DI for i18n &quot;enume&quot; Object DI for enum &quot;moment&quot; Object DI for moment &quot;config&quot; Object DI for config &quot;ethHelper&quot; Object DI for ethHelper Source: eth/contract/ContractModel.js, line 14 × Search results Close "},"module-contract-ContractService.html":{"id":"module-contract-ContractService.html","title":"Class: ContractService","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Class: ContractService contract~ ContractService new ContractService(&quot;exceptions&quot;) Service that will handle payments lifecycle Parameters: Name Type Description &quot;exceptions&quot; Object DI for exceptions Source: eth/contract/ContractService.js, line 16 × Search results Close "},"module-contract-LockerModel.html":{"id":"module-contract-LockerModel.html","title":"Class: LockerModel","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Class: LockerModel contract~ LockerModel new LockerModel(&quot;db&quot;, &quot;i18n&quot;, &quot;enume&quot;, &quot;moment&quot;, &quot;config&quot;, &quot;ethHelper&quot;) Model to handle the contracts collection Parameters: Name Type Description &quot;db&quot; Object DI for database &quot;i18n&quot; Object DI for i18n &quot;enume&quot; Object DI for enum &quot;moment&quot; Object DI for moment &quot;config&quot; Object DI for config &quot;ethHelper&quot; Object DI for ethHelper Source: eth/locker/LockerModel.js, line 14 × Search results Close "},"module-contract-LockerService.html":{"id":"module-contract-LockerService.html","title":"Class: LockerService","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Class: LockerService contract~ LockerService new LockerService(&quot;exceptions&quot;) Service that will handle payments lifecycle Parameters: Name Type Description &quot;exceptions&quot; Object DI for exceptions Source: eth/locker/LockerService.js, line 16 × Search results Close "},"module-transaction.html":{"id":"module-transaction.html","title":"Module: transaction","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Module: transaction Source: eth/transaction/TransactionService.js, line 14 Classes TransactionModel TransactionService Module: transaction Source: eth/transaction/TransactionModel.js, line 12 Classes TransactionModel TransactionService × Search results Close "},"module-transaction-TransactionModel.html":{"id":"module-transaction-TransactionModel.html","title":"Class: TransactionModel","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Class: TransactionModel transaction~ TransactionModel new TransactionModel(&quot;db&quot;, &quot;i18n&quot;, &quot;enume&quot;, &quot;moment&quot;, &quot;config&quot;, &quot;ethHelper&quot;) Model to handle the transactions collection Parameters: Name Type Description &quot;db&quot; Object DI for database &quot;i18n&quot; Object DI for i18n &quot;enume&quot; Object DI for enum &quot;moment&quot; Object DI for moment &quot;config&quot; Object DI for config &quot;ethHelper&quot; Object DI for ethHelper Source: eth/transaction/TransactionModel.js, line 14 × Search results Close "},"module-transaction-TransactionService.html":{"id":"module-transaction-TransactionService.html","title":"Class: TransactionService","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Class: TransactionService transaction~ TransactionService new TransactionService(&quot;exceptions&quot;) Service that will handle payments lifecycle Parameters: Name Type Description &quot;exceptions&quot; Object DI for exceptions Source: eth/transaction/TransactionService.js, line 16 × Search results Close "},"Response.html":{"id":"Response.html","title":"Class: Response","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Class: Response Response new Response() Creates a new Response object. Source: struct/Response.js, line 9 Methods getCode() Get code Source: struct/Response.js, line 45 getData() Get response body Source: struct/Response.js, line 40 getMessage() Get Message Source: struct/Response.js, line 50 getStatus() Get Error Source: struct/Response.js, line 55 × Search results Close "},"ServerExceptions.html":{"id":"ServerExceptions.html","title":"Class: ServerExceptions","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Class: ServerExceptions ServerExceptions new ServerExceptions(&quot;i18n&quot;, &quot;restify&quot;, &quot;logger&quot;, &quot;util&quot;, &quot;exceptions&quot;) → {Object} Class that will handle Restify exceptions Parameters: Name Type Description &quot;i18n&quot; Object DI for i18n &quot;restify&quot; Object DI for restify &quot;logger&quot; Object DI for logger &quot;util&quot; Object DI for util &quot;exceptions&quot; Object DI for exceptions Source: exception/ServerExceptions.js, line 16 Returns: Returns a new ServerExceptions object. Type Object Methods createException(error,) → {object} Generates a new restify exception based on err instance Parameters: Name Type Description error, object Error object Source: exception/ServerExceptions.js, line 39 Returns: Returns a new restify exception object. Type object Example Error types: Base: ServiceException, AccessDenied: AccessDeniedException, NotFound: NotFoundException, Validation: ValidationException, Internal: InternalException getExceptionInstanceOf(error,) → {string} Returns the error type (instanceof or constructor name) Parameters: Name Type Description error, object Error object Source: exception/ServerExceptions.js, line 99 Returns: instanceof or constructor name. Type string × Search results Close "},"ServerSetup.html":{"id":"ServerSetup.html","title":"Class: ServerSetup","body":" EthInt Api Namespaces eth Modules accountcontracttransaction Classes account~AccountModelaccount~AccountServicecontract~ContractModelcontract~ContractServicecontract~LockerModelcontract~LockerServicetransaction~TransactionModeltransaction~TransactionServiceResponseServerExceptionsServerSetup Class: ServerSetup ServerSetup new ServerSetup('restify', 'logger', 'util', 'app_name', 'app_version') → {Object} Service that will manage the creation of new API servers Parameters: Name Type Description 'restify' Object DI for restify 'logger' Object DI for logger 'util' Object DI for util 'app_name' Object DI for app_name 'app_version' Object DI for app_version Source: server.js, line 26 Returns: Returns a new ServerSetup service object. Type Object Methods createAPIServer('config') → {Object} Parameters: Name Type Description 'config' Object Configuration object for the new API server Source: server.js, line 49 Returns: Returns a new API server. Type Object Example Example usage of createAPIServer var server = serverSetup.createAPIServer(config); × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
